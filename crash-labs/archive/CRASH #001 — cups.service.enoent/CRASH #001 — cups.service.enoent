============================================================
üß© CRASH #001 ‚Äî cups.service (status=203/EXEC) ‚Üí ENOENT
============================================================
üìÖ Data: 2025-10-26  
üß© Obiettivo: Riprodurre un errore ENOENT causato da una modifica manuale alla unit cups.service.  
üìÇ Distro: Debian 12 (kernel 6.x)

------------------------------------------------------------
üîç CONTESTO
------------------------------------------------------------
La unit originale:

/usr/lib/systemd/system/cups.service

√® stata copiata manualmente in:

/etc/systemd/system/cups.service


All‚Äôinterno del file copiato, la direttiva ExecStart √® stata modificata in:

ExecStart=/usr/sbin/cupsd_fake

Il binario `cupsd_fake` non esiste.  
Dopo aver eseguito:

```bash
systemctl daemon-reload && systemctl restart cups

il servizio √® fallito con:

Process: 3870 ExecStart=/usr/sbin/cupsd_fake (code=exited, status=203/EXEC)

systemd ha riportato ‚ÄúNo such file or directory‚Äù (ENOENT).

------------------------------------------------------------
üìä INDAGINE
------------------------------------------------------------
La execve() fallita non √® stata invocata dal servizio stesso,
ma da systemd (PID 1) ‚Äî il processo responsabile dell‚Äôavvio delle unit.

Per catturare l‚Äôerrore √® necessario agganciare la traccia a PID 1,
monitorando esclusivamente la creazione di processi e le syscall di accesso ai file:

sudo strace -f -e trace=process,open,openat,execve -p 1

Output rilevante:

[pid 3870] openat(AT_FDCWD, "/usr/sbin/cupsd_fake", O_RDONLY|O_CLOEXEC|O_PATH) = -1 ENOENT (No such file or directory)
[pid 3870] +++ exited with 203 +++

Questo mostra che systemd ha tentato di aprire il binario definito in ExecStart,
il kernel ha restituito ENOENT, e il processo figlio √® uscito con codice 203.

Solo tracciando open/openat su PID 1
√® possibile individuare il file mancante ‚Äî una traccia generica non basta.

------------------------------------------------------------
‚úÖ CONCLUSIONE
------------------------------------------------------------
L‚Äôoverride in /etc/systemd/system/ sostituisce completamente la unit originale.

Lo stato status=203/EXEC deriva da un openat() su un binario inesistente.

L‚Äôerrore √® generato da systemd (PID 1), non dal servizio stesso.

La diagnosi corretta richiede la tracciatura delle syscall del processo padre.

------------------------------------------------------------
üß© NOTE
------------------------------------------------------------
    ExecStart errato ‚Üí openat() fallisce ‚Üí ENOENT ‚Üí status=203/EXEC.

    systemd valida sempre il percorso dell‚Äôeseguibile prima di invocare execve().

    Le override locali sono un metodo sicuro per generare crash controllati (ENOENT).

============================================================
‚è± Tempo totale ~20 minuti
